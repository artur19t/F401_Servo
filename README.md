# STM32F401 UART ‚Üí Servo Control (DMA + PWM)

–£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ **STM32F401**, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–æ–ø—Ä–∏–≤–æ–¥–æ–º –ø–æ UART —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **DMA –≤ Circular Mode**, –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ **PWM**.

---

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–≥–ª–æ–º –ø–æ–≤–æ—Ä–æ—Ç–∞ —Å–µ—Ä–≤–æ–ø—Ä–∏–≤–æ–¥–∞ **EMAX ES3001** –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–º—É —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å **USART2**.

–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è –ø–æ UART —Å –ø–æ–º–æ—â—å—é **DMA –≤ —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–º —Ä–µ–∂–∏–º–µ (Circular Mode)**. –ü–æ–ª—É—á–µ–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–∞—Ä—Å–∏—Ç—Å—è, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ —á–∏—Å–ª–æ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∫–≤–∞–∂–Ω–æ—Å—Ç–∏ PWM-—Å–∏–≥–Ω–∞–ª–∞, —É–ø—Ä–∞–≤–ª—è—é—â–µ–≥–æ —Å–µ—Ä–≤–æ–ø—Ä–∏–≤–æ–¥–æ–º.

---

## –ò—Å–ø–æ–ª—å–∑—É–µ–º–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ

- **–ú–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä:** STM32F401  
- **–°–µ—Ä–≤–æ–ø—Ä–∏–≤–æ–¥:** EMAX ES3001  
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –ø–∏—Ç–∞–Ω–∏—è:** –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–π –±–ª–æ–∫ –ø–∏—Ç–∞–Ω–∏—è FNIRSI
- **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–≤—è–∑–∏:** USART2  
- **–°—Ä–µ–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:** STM32CubeIDE

---

## ‚öôÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### UART
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **USART2**
- –ü—Ä–∏—ë–º –¥–∞–Ω–Ω—ã—Ö –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ **DMA**
- –†–µ–∂–∏–º DMA: **Circular Mode**
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ü–∞ –ø–∞–∫–µ—Ç–∞ ‚Äî –ø–æ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—é **IDLE Line**

### DMA
- –†–µ–∂–∏–º: Circular
- –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç –ø–∞–º—è—Ç–∏: –≤–∫–ª—é—á—ë–Ω
- –†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö: byte

### PWM
- –¢–∞–π–º–µ—Ä: **TIM3**
- –ß–∞—Å—Ç–æ—Ç–∞ PWM: **50 –ì—Ü**
- –î–∏–∞–ø–∞–∑–æ–Ω —É–ø—Ä–∞–≤–ª—è—é—â–µ–≥–æ –∏–º–ø—É–ª—å—Å–∞: **600‚Äì2200 –º–∫—Å**
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–≥–ª–æ–º —Å–µ—Ä–≤–æ–ø—Ä–∏–≤–æ–¥–∞: **0‚Äì180¬∞**

---

## –§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–ü–æ UART –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è ASCII-—Å—Ç—Ä–æ–∫–∞, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ

–î–æ–ø—É—Å—Ç–∏–º—ã —Ç–æ–ª—å–∫–æ —Å–∏–º–≤–æ–ª—ã `'0'‚Äì'9'`.

---

## üß† –ü–∞—Ä—Å–µ—Ä –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–∞—Ä—Å–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤—Ö–æ–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É –≤ —á–∏—Å–ª–æ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏.

### –í–æ–∑–º–æ–∂–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–∞—Ä—Å–µ—Ä–∞:

```c
PARSE_OK
PARSE_ERR_EMPTY
PARSE_ERR_NOT_DIGIT
PARSE_ERR_OVERFLOW
```

### –ü–æ–≤–µ–¥–µ–Ω–∏–µ:
- –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Üí `PARSE_ERR_EMPTY`
- –ù–∞–ª–∏—á–∏–µ –Ω–µ—Ü–∏—Ñ—Ä–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ ‚Üí `PARSE_ERR_NOT_DIGIT`
- –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∏–ø–∞ `uint32_t` ‚Üí `PARSE_ERR_OVERFLOW`
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —á–∏—Å–ª–æ ‚Üí `PARSE_OK`

---

## –õ–æ–≥–∏–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–æ–ø—Ä–∏–≤–æ–¥–æ–º

1. –ü—Ä–∏—ë–º –¥–∞–Ω–Ω—ã—Ö –ø–æ UART (DMA + IDLE)
2. –ü–µ—Ä–µ–¥–∞—á–∞ –±—É—Ñ–µ—Ä–∞ –≤ –ø–∞—Ä—Å–µ—Ä
3. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –≤ —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
4. –ü–µ—Ä–µ—Å—á—ë—Ç —É–≥–ª–∞ –≤ –∑–Ω–∞—á–µ–Ω–∏–µ PWM
5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è `CCR` —Ç–∞–π–º–µ—Ä–∞ TIM3
